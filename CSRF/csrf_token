<?php
composer require symfony/security-csrf

// config/packages/framework.php
use Symfony\Config\FrameworkConfig;

return static function (FrameworkConfig $framework): void {
    $framework->csrfProtection()
        ->enabled(true)
    ;
};


// config/packages/security.php
use Symfony\Config\SecurityConfig;

return static function (SecurityConfig $security): void {
    $mainFirewall = $security->firewall('main');
    $mainFirewall->formLogin()
        ->enableCsrf(true)
    ;
};


// {# templates/login/index.html.twig #}

// {# ... #}
<form action="{{ path('app_login') }}" method="post">
    // {# ... the login fields #}

    <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

    <button type="submit">login</button>
</form>

?>